---
import styles from './Hero.module.scss';
import { Icon } from 'astro-icon/components';
---

<aside class={styles.sidebar}>
  <div class={styles.sidebarContent}>
    <div class={styles.header}>
      <h1 class={styles.name} id="typed-name"></h1>
      <p class={styles.title} id="hero-title">Software Developer</p>
      <p class={styles.tagline} id="hero-tagline">
        Dedicated to building meaningful solutions with expert craftsmanship.
      </p>
    </div>

    <nav class={styles.nav} id="hero-nav">
      <ul class={styles.navList}>
        <li>
          <a href="#about" class={styles.navLink} data-section="about">About</a>
        </li>
        <li>
          <a href="#skills" class={styles.navLink} data-section="skills"
            >Tools</a
          >
        </li>
        <li>
          <a href="#projects" class={styles.navLink} data-section="projects"
            >Projects</a
          >
        </li>
        <li>
          <a href="#blog" class={styles.navLink} data-section="blog">Blog</a>
        </li>
      </ul>
    </nav>

    <div class={styles.social} id="hero-social">
      <a
        href="https://github.com/jaleeson11"
        target="_blank"
        rel="noopener noreferrer"
        class={styles.socialLink}
        aria-label="GitHub"
      >
        <Icon name="simple-icons:github" />
      </a>
      <a
        href="https://linkedin.com/in/joeleeson"
        target="_blank"
        rel="noopener noreferrer"
        class={styles.socialLink}
        aria-label="LinkedIn"
      >
        <Icon name="simple-icons:linkedin" />
      </a>
    </div>
  </div>
</aside>

<script>
  const nameElement = document.getElementById('typed-name');
  const titleElement = document.getElementById('hero-title');
  const taglineElement = document.getElementById('hero-tagline');
  const navElement = document.getElementById('hero-nav');
  const socialElement = document.getElementById('hero-social');
  const fullName = 'Joe Leeson';
  let currentIndex = 0;

  if (nameElement) {
    nameElement.textContent = '';

    function typeNextCharacter() {
      if (currentIndex < fullName.length) {
        nameElement.textContent += fullName[currentIndex];
        currentIndex++;
        setTimeout(typeNextCharacter, 100);
      } else {
        // Remove cursor instantly and start revealing elements
        nameElement.setAttribute('data-typing', 'complete');
        revealElements();
      }
    }

    function revealElements() {
      // Reveal title after 200ms
      setTimeout(() => {
        if (titleElement) titleElement.setAttribute('data-reveal', 'true');
      }, 200);

      // Reveal tagline after 400ms
      setTimeout(() => {
        if (taglineElement) taglineElement.setAttribute('data-reveal', 'true');
      }, 400);

      // Reveal nav after 600ms
      setTimeout(() => {
        if (navElement) navElement.setAttribute('data-reveal', 'true');
      }, 600);

      // Reveal social after 800ms
      setTimeout(() => {
        if (socialElement) socialElement.setAttribute('data-reveal', 'true');
      }, 800);
    }

    // Start typing after a short delay
    setTimeout(typeNextCharacter, 300);
  }

  // Scroll spy functionality
  const sections = document.querySelectorAll('section[id]');
  const navLinks = document.querySelectorAll('[data-section]');

  const observerOptions = {
    root: null,
    rootMargin: '-50% 0px -50% 0px',
    threshold: 0,
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const sectionId = entry.target.getAttribute('id');
        navLinks.forEach((link) => {
          if (link.getAttribute('data-section') === sectionId) {
            link.classList.add('active');
          } else {
            link.classList.remove('active');
          }
        });
      }
    });
  }, observerOptions);

  sections.forEach((section) => {
    observer.observe(section);
  });
</script>
